@page
@using Microsoft.AspNetCore.Http
@model WebHomePro.Pages.Cliente.MenuClienteModel
@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>HomePro - Menú Cliente</title>
    <link rel="icon" type="image/x-icon" href="~/assets/favicon.ico" />

    <!-- Font Awesome -->
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" />

    <!-- Bootstrap + Estilos -->
    <link href="~/css/StyleMenuAdmin.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
        <div class="container px-4 px-lg-5">
            <a class="navbar-brand" asp-page="/Cliente/MenuCliente">
                <img src="~/img/LOGO HOMEPRO.png" alt="Logo" style="height: 5rem;" />
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive">
                Menu <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto py-4 py-lg-0">

                    <!-- Opciones del menú -->
                    <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" asp-page="/Cliente/Lineas">Líneas Activas a su Nombre</a></li>

                    <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" asp-page="/Cliente/CargarSaldo">Cargar saldo a línea PREPAGO</a></li>

                    <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" asp-page="/Cliente/PagarFactura">Pagar factura Pendiente</a></li>

                    <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" asp-page="/#">Devolver una Línea</a></li>

                    <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" asp-page="/Login">Salir del Sitio</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- HEADER -->
    <header class="masthead" style="background-image: url('@Url.Content("~/img/home-bg.jpg")')">
        <div class="container position-relative px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-10 col-lg-8 col-xl-7">
                    <div class="site-heading">
                        <h1>HomePro</h1>
                        <span class="subheading">Gestioná tus líneas fácilmente</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- CONTENIDO CLIENTE -->
    <section class="py-5">
        <div class="container">

            @if (!string.IsNullOrWhiteSpace(Model.Error))
            {
                <div class="alert alert-danger">@Model.Error</div>
            }

            <!-- PREPAGO -->
            <h3>📱 Líneas Prepago</h3>
            @if (Model.LineasPrepago.Count == 0)
            {
                <div class="alert alert-info">No tienes líneas prepago registradas.</div>
            }
            else
            {
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Teléfono</th>
                            <th class="text-end">Saldo disponible</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var l in Model.LineasPrepago)
                        {
                            <tr ondblclick="location.href='@Url.Page("/Cliente/CargarSaldo", new { telefono = l.Telefono })'">
                                <td>@l.Telefono</td>
                                <td class="text-end">@l.SaldoDisponible.ToString("N2")</td>
                            </tr>
                        }
                    </tbody>
                </table>
                <p class="text-muted"><small>💡 Doble clic sobre un teléfono para recargar saldo.</small></p>
            }

            <hr />

            <!-- POSTPAGO -->
            <h3>📞 Líneas Postpago</h3>
            @if (Model.LineasPostpago.Count == 0)
            {
                <div class="alert alert-info">No tienes líneas postpago registradas.</div>
            }
            else
            {
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Teléfono</th>
                            <th class="text-end">Monto pendiente</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var l in Model.LineasPostpago)
                        {
                            <tr ondblclick="@(l.MontoPendiente > 0
                                                                                ? $"location.href='{Url.Page("/Cliente/PagarFactura", new { telefono = l.Telefono })}'"
                                                                                : "alert('Esta línea no tiene facturación pendiente.')")">
                        <td>@l.Telefono</td>
                        <td class="text-end">@l.MontoPendiente.ToString("N2")</td>
                    </tr>
                                        }
                    </tbody>
                </table>
                <p class="text-muted"><small>💡 Doble clic sobre un teléfono con monto pendiente para pagar factura.</small></p>
            }

        </div>
    </section>

    <!-- FOOTER -->
    <footer class="border-top">
        <div class="container px-4 px-lg-5 text-center">
            <div class="small text-muted fst-italic">Derechos Reservados &copy; HomePro 2025</div>
        </div>
    </footer>

    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/scripts.js"></script>
</body>
</html>
